{"version":3,"file":"2-form.js","sources":["../src/js/form-errors.js","../src/js/refs.js","../src/js/form-check-logic.js","../src/js/2-form.js"],"sourcesContent":["export const emailErrorMsg = `<div class=\"form-email-error-msg\">Please, enter correct email</div>`;\nexport const emptyErrorMsg = `<div class=\"form-error-empty-msg is-onscreen\">This field is required</div>`;\n","export let refs = {\n  form: document.querySelector('.feedback-form'),\n  emailInput: document.getElementById('userEmail'),\n  textInput: document.getElementById('userMsg'),\n  emailErrorMsg: document.querySelector('.form-email-error-msg'),\n  emptyErrorMsg: document.querySelector('.form-error-empty-msg'),\n};\n","import { emailErrorMsg, emptyErrorMsg } from './form-errors';\nimport { refs } from './refs';\n\nconst STORAGE_KEY = 'feedback-form-state';\nconst form = refs.form;\nconst emailInput = refs.emailInput;\nconst textInput = refs.textInput;\n\nlet msgTimeoutId = null;\nlet emailTimeoutId = null;\nlet shakeId = null;\n\nexport function emailCheck() {\n  const correctEmailRule = refs.emailInput.value.match(\n    /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/\n  );\n\n  if (refs.emailInput.value === '') {\n    const existingError = refs.emailInput.parentElement.querySelector(\n      '.form-error-empty-msg'\n    );\n    if (existingError) existingError.remove();\n\n    refs.emailInput.style.borderColor = 'tomato';\n    refs.emailInput.insertAdjacentHTML('afterend', emptyErrorMsg);\n\n    const emptyError = refs.emailInput.parentElement.querySelector(\n      '.form-error-empty-msg'\n    );\n    emptyError.classList.add('is-onscreen');\n\n    if (emailTimeoutId) clearTimeout(emailTimeoutId);\n    emailTimeoutId = setTimeout(() => {\n      refs.emailInput.style.borderColor = '';\n      emptyError.classList.remove('is-onscreen');\n      emptyError.remove();\n    }, 5000);\n\n    return false;\n  } else if (!correctEmailRule) {\n    const existingError = refs.emailInput.parentElement.querySelector(\n      '.form-email-error-msg'\n    );\n    if (existingError) existingError.remove();\n\n    refs.emailInput.style.borderColor = 'tomato';\n    refs.emailInput.insertAdjacentHTML('afterend', emailErrorMsg);\n\n    const emailError = refs.emailInput.parentElement.querySelector(\n      '.form-email-error-msg'\n    );\n    emailError.classList.add('is-onscreen');\n\n    if (emailTimeoutId) clearTimeout(emailTimeoutId);\n    emailTimeoutId = setTimeout(() => {\n      refs.emailInput.style.borderColor = '';\n      emailError.classList.remove('is-onscreen');\n      emailError.remove();\n    }, 5000);\n\n    return false;\n  } else {\n    refs.emailInput.style.borderColor = '';\n    if (emailTimeoutId) clearTimeout(emailTimeoutId);\n\n    return true;\n  }\n}\n\nexport function msgCheck() {\n  if (refs.textInput.value.trim() === '') {\n    const existingError = refs.textInput.parentElement.querySelector(\n      '.form-error-empty-msg'\n    );\n    if (existingError) existingError.remove();\n\n    refs.textInput.style.borderColor = 'tomato';\n    refs.textInput.insertAdjacentHTML('afterend', emptyErrorMsg);\n\n    const emptyError = refs.textInput.parentElement.querySelector(\n      '.form-error-empty-msg'\n    );\n    emptyError.classList.add('is-onscreen');\n\n    if (msgTimeoutId) clearTimeout(msgTimeoutId);\n    msgTimeoutId = setTimeout(() => {\n      refs.textInput.style.borderColor = '';\n      emptyError.classList.remove('is-onscreen');\n      emptyError.remove();\n    }, 5000);\n\n    return false;\n  } else {\n    refs.textInput.style.borderColor = '';\n    if (msgTimeoutId) clearTimeout(msgTimeoutId);\n\n    return true;\n  }\n}\n\nexport function handleFormSubmit(event) {\n  event.preventDefault();\n  const form = event.currentTarget;\n  const isMsgFilled = msgCheck();\n  const isEmailValid = emailCheck();\n\n  localStorage.removeItem(STORAGE_KEY);\n\n  if (!isEmailValid) {\n    if (refs.emailInput.value === '') {\n      const existingError = refs.emailInput.parentElement.querySelector(\n        '.form-error-empty-msg'\n      );\n      if (existingError) existingError.remove();\n      refs.emailInput.insertAdjacentHTML('afterend', emptyErrorMsg);\n      waitForElement(\n        '.form-error-empty-msg',\n        refs.emailInput.parentElement,\n        shakeError => {\n          triggerShake(shakeError);\n        }\n      );\n    } else {\n      const existingError = refs.emailInput.parentElement.querySelector(\n        '.form-email-error-msg'\n      );\n      if (existingError) existingError.remove();\n      refs.emailInput.insertAdjacentHTML('afterend', emailErrorMsg);\n      waitForElement(\n        '.form-email-error-msg',\n        refs.emailInput.parentElement,\n        shakeError => {\n          triggerShake(shakeError);\n        }\n      );\n    }\n  }\n\n  if (!isMsgFilled) {\n    const existingError = refs.textInput.parentElement.querySelector(\n      '.form-error-empty-msg'\n    );\n    if (existingError) existingError.remove();\n    refs.textInput.insertAdjacentHTML('afterend', emptyErrorMsg);\n    waitForElement(\n      '.form-error-empty-msg',\n      refs.textInput.parentElement,\n      shakeError => {\n        triggerShake(shakeError);\n      }\n    );\n\n    if (shakeId) clearTimeout(shakeId);\n    shakeId = setTimeout(() => {\n      refs.textInput.parentElement\n        .querySelector('.form-error-empty-msg')\n        .remove();\n    }, 5000);\n  }\n\n  if (!isMsgFilled || !isEmailValid) return;\n\n  const savedLSData = localStorage.getItem(STORAGE_KEY);\n  if (savedLSData) {\n    try {\n      const dataFromLS = JSON.parse(savedLSData);\n      console.log('Submitted data:', dataFromLS);\n    } catch (error) {\n      console.log('Submitted data: <invalid JSON>');\n    }\n  } else {\n    console.log('Please, fill all fields');\n  }\n\n  form.reset();\n}\n\nexport function handleFormInput(event) {\n  const form = event.currentTarget;\n  const formData = new FormData(form);\n  const filteredData = Array.from(formData.entries()).filter(\n    ([_, value]) => value && value.trim() !== ''\n  );\n\n  if (filteredData.length > 0) {\n    const formDataObj = Object.fromEntries(filteredData);\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(formDataObj));\n  } else {\n    localStorage.removeItem(STORAGE_KEY);\n  }\n}\n\nexport function populateForm() {\n  const savedLSData = localStorage.getItem(STORAGE_KEY);\n\n  if (!savedLSData) return;\n\n  try {\n    const dataFromLS = JSON.parse(savedLSData);\n    Object.keys(dataFromLS).forEach(field => {\n      if (\n        form.elements[field] &&\n        dataFromLS[field] !== undefined &&\n        dataFromLS[field] !== ''\n      ) {\n        form.elements[field].value = dataFromLS[field];\n      }\n    });\n  } catch (error) {\n    alert('Ooops... something went wrong');\n  }\n}\n\nfunction waitForElement(selector, parent, callback) {\n  const observer = new MutationObserver((mutationsList, observer) => {\n    const element = parent.querySelector(selector);\n    if (element) {\n      observer.disconnect();\n      callback(element);\n    }\n  });\n\n  observer.observe(parent, { childList: true, subtree: true });\n}\n\nexport function triggerShake(el) {\n  el.classList.add('shake');\n  setTimeout(() => {\n    el.classList.remove('shake');\n  }, 350);\n}\n","import {\n  emailCheck,\n  msgCheck,\n  handleFormSubmit,\n  handleFormInput,\n  populateForm,\n} from './form-check-logic.js';\nimport { refs } from './refs';\n\nconst form = refs.form;\nconst emailInput = refs.emailInput;\nconst textInput = refs.textInput;\n\npopulateForm();\n\nemailInput.addEventListener('blur', emailCheck);\n\ntextInput.addEventListener('blur', msgCheck);\n\nform.addEventListener('submit', handleFormSubmit);\n\nform.addEventListener('focusout', handleFormInput);\n\n// function handleFormSubmit(event) {\n//   event.preventDefault();\n//   const form = event.currentTarget;\n\n//   const savedLSData = localStorage.getItem(STORAGE_KEY);\n//   if (savedLSData) {\n//     try {\n//       const dataFromLS = JSON.parse(savedLSData);\n//       console.log('Submitted data:', dataFromLS);\n//     } catch (error) {\n//       console.log('Submitted data: <invalid JSON>');\n//     }\n//   } else {\n//     console.log('Please, fill all fields');\n//   }\n\n//   localStorage.removeItem(STORAGE_KEY);\n\n//   form.reset();\n// }\n"],"names":["emailErrorMsg","emptyErrorMsg","refs","STORAGE_KEY","form","msgTimeoutId","emailTimeoutId","shakeId","emailCheck","correctEmailRule","existingError","emptyError","emailError","msgCheck","handleFormSubmit","event","isMsgFilled","isEmailValid","waitForElement","shakeError","triggerShake","savedLSData","dataFromLS","handleFormInput","formData","filteredData","_","value","formDataObj","populateForm","field","selector","parent","callback","mutationsList","observer","element","el","emailInput","textInput"],"mappings":"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"}