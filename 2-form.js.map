{"version":3,"file":"2-form.js","sources":["../src/js/form-errors.js","../src/js/refs.js","../src/js/form-check-logic.js","../src/js/2-form.js"],"sourcesContent":["export const emailErrorMsg = `<div class=\"form-email-error-msg\">Please, enter correct email</div>`;\nexport const emptyErrorMsg = `<div class=\"form-error-empty-msg is-onscreen\">This field is required</div>`;\n","export let refs = {\n  form: document.querySelector('.feedback-form'),\n  emailInput: document.getElementById('userEmail'),\n  textInput: document.getElementById('userMsg'),\n  emailErrorMsg: document.querySelector('.form-email-error-msg'),\n  emptyErrorMsg: document.querySelector('.form-error-empty-msg'),\n};\n","import { emailErrorMsg, emptyErrorMsg } from './form-errors';\nimport { refs } from './refs';\n\nconst STORAGE_KEY = 'feedback-form-state';\nconst form = refs.form;\nconst emailInput = refs.emailInput;\nconst textInput = refs.textInput;\n\nlet msgTimeoutId = null;\nlet emailTimeoutId = null;\nlet shakeId = null;\n\nexport function emailCheck() {\n  const correctEmailRule = emailInput.value.match(\n    /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/\n  );\n\n  if (emailInput.value === '') {\n    const existingError = emailInput.parentElement.querySelector(\n      '.form-error-empty-msg'\n    );\n    if (existingError) existingError.remove();\n\n    emailInput.style.borderColor = 'tomato';\n    emailInput.insertAdjacentHTML('afterend', emptyErrorMsg);\n\n    const emptyError = emailInput.parentElement.querySelector(\n      '.form-error-empty-msg'\n    );\n    emptyError.classList.add('is-onscreen');\n\n    if (emailTimeoutId) clearTimeout(emailTimeoutId);\n    emailTimeoutId = setTimeout(() => {\n      emailInput.style.borderColor = '';\n      emptyError.classList.remove('is-onscreen');\n      emptyError.remove();\n    }, 5000);\n\n    return false;\n  } else if (!correctEmailRule) {\n    const existingError = emailInput.parentElement.querySelector(\n      '.form-email-error-msg'\n    );\n    if (existingError) existingError.remove();\n\n    emailInput.style.borderColor = 'tomato';\n    emailInput.insertAdjacentHTML('afterend', emailErrorMsg);\n\n    const emailError = emailInput.parentElement.querySelector(\n      '.form-email-error-msg'\n    );\n    emailError.classList.add('is-onscreen');\n\n    if (emailTimeoutId) clearTimeout(emailTimeoutId);\n    emailTimeoutId = setTimeout(() => {\n      emailInput.style.borderColor = '';\n      emailError.classList.remove('is-onscreen');\n      emailError.remove();\n    }, 5000);\n\n    return false;\n  } else {\n    emailInput.style.borderColor = '';\n    if (emailTimeoutId) clearTimeout(emailTimeoutId);\n\n    return true;\n  }\n}\n\nexport function msgCheck() {\n  if (textInput.value.trim() === '') {\n    const existingError = textInput.parentElement.querySelector(\n      '.form-error-empty-msg'\n    );\n    if (existingError) existingError.remove();\n\n    textInput.style.borderColor = 'tomato';\n    textInput.insertAdjacentHTML('afterend', emptyErrorMsg);\n\n    const emptyError = textInput.parentElement.querySelector(\n      '.form-error-empty-msg'\n    );\n    emptyError.classList.add('is-onscreen');\n\n    if (msgTimeoutId) clearTimeout(msgTimeoutId);\n    msgTimeoutId = setTimeout(() => {\n      textInput.style.borderColor = '';\n      emptyError.classList.remove('is-onscreen');\n      emptyError.remove();\n    }, 5000);\n\n    return false;\n  } else {\n    textInput.style.borderColor = '';\n    if (msgTimeoutId) clearTimeout(msgTimeoutId);\n\n    return true;\n  }\n}\n\nexport function handleFormSubmit(event) {\n  event.preventDefault();\n  const form = event.currentTarget;\n\n  const isMsgFilled = msgCheck();\n  const isEmailValid = emailCheck();\n\n  if (!isMsgFilled || !isEmailValid) {\n    // console.log('Please, fill all fields');\n    return;\n  }\n\n  // if (!isEmailValid) {\n  //   if (emailInput.value === '') {\n  //     const existingError = emailInput.parentElement.querySelector(\n  //       '.form-error-empty-msg'\n  //     );\n  //     if (existingError) existingError.remove();\n  //     emailInput.insertAdjacentHTML('afterend', emptyErrorMsg);\n  //     waitForElement(\n  //       '.form-error-empty-msg',\n  //       emailInput.parentElement,\n  //       shakeError => {\n  //         triggerShake(shakeError);\n  //       }\n  //     );\n  //   } else {\n  //     const existingError = emailInput.parentElement.querySelector(\n  //       '.form-email-error-msg'\n  //     );\n  //     if (existingError) existingError.remove();\n  //     emailInput.insertAdjacentHTML('afterend', emailErrorMsg);\n  //     waitForElement(\n  //       '.form-email-error-msg',\n  //       emailInput.parentElement,\n  //       shakeError => {\n  //         triggerShake(shakeError);\n  //       }\n  //     );\n  //   }\n  // }\n\n  // if (!isMsgFilled) {\n  //   const existingError = textInput.parentElement.querySelector(\n  //     '.form-error-empty-msg'\n  //   );\n  //   if (existingError) existingError.remove();\n  //   textInput.insertAdjacentHTML('afterend', emptyErrorMsg);\n  //   waitForElement(\n  //     '.form-error-empty-msg',\n  //     textInput.parentElement,\n  //     shakeError => {\n  //       triggerShake(shakeError);\n  //     }\n  //   );\n\n  //   if (shakeId) clearTimeout(shakeId);\n  //   shakeId = setTimeout(() => {\n  //     textInput.parentElement.querySelector('.form-error-empty-msg').remove();\n  //   }, 5000);\n  // }\n\n  const savedLSData = localStorage.getItem(STORAGE_KEY);\n  if (savedLSData) {\n    try {\n      const dataFromLS = JSON.parse(savedLSData);\n      console.log('Submitted data:', dataFromLS);\n    } catch (error) {\n      console.log('Submitted data: <invalid JSON>');\n    }\n  }\n\n  localStorage.removeItem(STORAGE_KEY);\n  form.reset();\n}\n\nexport function handleFormInput(event) {\n  const form = event.currentTarget;\n  const formData = new FormData(form);\n  const filteredData = Array.from(formData.entries()).filter(\n    ([_, value]) => value && value.trim() !== ''\n  );\n\n  if (filteredData.length > 0) {\n    const formDataObj = Object.fromEntries(filteredData);\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(formDataObj));\n  } else {\n    localStorage.removeItem(STORAGE_KEY);\n  }\n}\n\nexport function populateForm() {\n  const savedLSData = localStorage.getItem(STORAGE_KEY);\n\n  if (!savedLSData) return;\n\n  try {\n    const dataFromLS = JSON.parse(savedLSData);\n    Object.keys(dataFromLS).forEach(field => {\n      if (\n        form.elements[field] &&\n        dataFromLS[field] !== undefined &&\n        dataFromLS[field] !== ''\n      ) {\n        form.elements[field].value = dataFromLS[field];\n      }\n    });\n  } catch (error) {\n    alert('Ooops... something went wrong');\n  }\n}\n\nfunction waitForElement(selector, parent, callback) {\n  const observer = new MutationObserver((mutationsList, observer) => {\n    const element = parent.querySelector(selector);\n    if (element) {\n      observer.disconnect();\n      callback(element);\n    }\n  });\n\n  observer.observe(parent, { childList: true, subtree: true });\n}\n\nexport function triggerShake(el) {\n  el.classList.add('shake');\n  setTimeout(() => {\n    el.classList.remove('shake');\n  }, 350);\n}\n","import {\n  emailCheck,\n  msgCheck,\n  handleFormSubmit,\n  handleFormInput,\n  populateForm,\n} from './form-check-logic.js';\nimport { refs } from './refs';\n\nconst form = refs.form;\nconst emailInput = refs.emailInput;\nconst textInput = refs.textInput;\n\npopulateForm();\n\nemailInput.addEventListener('blur', emailCheck);\n\ntextInput.addEventListener('blur', msgCheck);\n\nform.addEventListener('submit', handleFormSubmit);\n\nform.addEventListener('input', handleFormInput);\n"],"names":["emailErrorMsg","emptyErrorMsg","refs","STORAGE_KEY","form","emailInput","textInput","msgTimeoutId","emailTimeoutId","emailCheck","correctEmailRule","existingError","emptyError","emailError","msgCheck","handleFormSubmit","event","isMsgFilled","isEmailValid","savedLSData","dataFromLS","handleFormInput","formData","filteredData","_","value","formDataObj","populateForm","field"],"mappings":"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"}