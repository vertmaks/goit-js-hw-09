{"version":3,"file":"2-form-Be_jlBmS.js","sources":["../../src/js/form-errors.js","../../src/js/refs.js","../../src/js/form-check-logic.js","../../src/js/2-form.js"],"sourcesContent":["export const emailErrorMsg = `<div class=\"form-email-error-msg\">Please, enter correct email</div>`;\nexport const emptyErrorMsg = `<div class=\"form-error-empty-msg is-onscreen\">This field is required</div>`;\n","export let refs = {\n  form: document.querySelector('.feedback-form'),\n  emailInput: document.getElementById('userEmail'),\n  textInput: document.getElementById('userMsg'),\n  emailErrorMsg: document.querySelector('.form-email-error-msg'),\n  emptyErrorMsg: document.querySelector('.form-error-empty-msg'),\n};\n","import { emailErrorMsg, emptyErrorMsg } from './form-errors';\nimport { refs } from './refs';\n\nlet msgTimeoutId = null;\nlet emailTimeoutId = null;\nlet shakeId = null;\n\nexport function emailCheck() {\n  const correctEmailRule = refs.emailInput.value.match(\n    /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/\n  );\n\n  if (refs.emailInput.value === '') {\n    const existingError = refs.emailInput.parentElement.querySelector(\n      '.form-error-empty-msg'\n    );\n    if (existingError) existingError.remove();\n\n    refs.emailInput.style.borderColor = 'tomato';\n    refs.emailInput.insertAdjacentHTML('afterend', emptyErrorMsg);\n\n    const emptyError = refs.emailInput.parentElement.querySelector(\n      '.form-error-empty-msg'\n    );\n    emptyError.classList.add('is-onscreen');\n\n    if (emailTimeoutId) clearTimeout(emailTimeoutId);\n    emailTimeoutId = setTimeout(() => {\n      refs.emailInput.style.borderColor = '';\n      emptyError.classList.remove('is-onscreen');\n      emptyError.remove();\n    }, 5000);\n\n    return false;\n  } else if (!correctEmailRule) {\n    const existingError = refs.emailInput.parentElement.querySelector(\n      '.form-email-error-msg'\n    );\n    if (existingError) existingError.remove();\n\n    refs.emailInput.style.borderColor = 'tomato';\n    refs.emailInput.insertAdjacentHTML('afterend', emailErrorMsg);\n\n    const emailError = refs.emailInput.parentElement.querySelector(\n      '.form-email-error-msg'\n    );\n    emailError.classList.add('is-onscreen');\n\n    if (emailTimeoutId) clearTimeout(emailTimeoutId);\n    emailTimeoutId = setTimeout(() => {\n      refs.emailInput.style.borderColor = '';\n      emailError.classList.remove('is-onscreen');\n      emailError.remove();\n    }, 5000);\n\n    return false;\n  } else {\n    refs.emailInput.style.borderColor = '';\n    if (emailTimeoutId) clearTimeout(emailTimeoutId);\n\n    return true;\n  }\n}\n\nexport function msgCheck() {\n  if (refs.textInput.value.trim() === '') {\n    const existingError = refs.textInput.parentElement.querySelector(\n      '.form-error-empty-msg'\n    );\n    if (existingError) existingError.remove();\n\n    refs.textInput.style.borderColor = 'tomato';\n    refs.textInput.insertAdjacentHTML('afterend', emptyErrorMsg);\n\n    const emptyError = refs.textInput.parentElement.querySelector(\n      '.form-error-empty-msg'\n    );\n    emptyError.classList.add('is-onscreen');\n\n    if (msgTimeoutId) clearTimeout(msgTimeoutId);\n    msgTimeoutId = setTimeout(() => {\n      refs.textInput.style.borderColor = '';\n      emptyError.classList.remove('is-onscreen');\n      emptyError.remove();\n    }, 5000);\n\n    return false;\n  } else {\n    refs.textInput.style.borderColor = '';\n    if (msgTimeoutId) clearTimeout(msgTimeoutId);\n\n    return true;\n  }\n}\n\nexport function formSubmit(event) {\n  event.preventDefault();\n  const form = refs.form;\n  const isMsgFilled = msgCheck();\n  const isEmailValid = emailCheck();\n\n  if (!isEmailValid) {\n    if (refs.emailInput.value === '') {\n      const existingError = refs.emailInput.parentElement.querySelector(\n        '.form-error-empty-msg'\n      );\n      if (existingError) existingError.remove();\n      refs.emailInput.insertAdjacentHTML('afterend', emptyErrorMsg);\n      waitForElement(\n        '.form-error-empty-msg',\n        refs.emailInput.parentElement,\n        shakeError => {\n          triggerShake(shakeError);\n        }\n      );\n    } else {\n      const existingError = refs.emailInput.parentElement.querySelector(\n        '.form-email-error-msg'\n      );\n      if (existingError) existingError.remove();\n      refs.emailInput.insertAdjacentHTML('afterend', emailErrorMsg);\n      waitForElement(\n        '.form-email-error-msg',\n        refs.emailInput.parentElement,\n        shakeError => {\n          triggerShake(shakeError);\n        }\n      );\n    }\n  }\n\n  if (!isMsgFilled) {\n    const existingError = refs.textInput.parentElement.querySelector(\n      '.form-error-empty-msg'\n    );\n    if (existingError) existingError.remove();\n    refs.textInput.insertAdjacentHTML('afterend', emptyErrorMsg);\n    waitForElement(\n      '.form-error-empty-msg',\n      refs.textInput.parentElement,\n      shakeError => {\n        triggerShake(shakeError);\n      }\n    );\n\n    if (shakeId) clearTimeout(shakeId);\n    shakeId = setTimeout(() => {\n      refs.textInput.parentElement\n        .querySelector('.form-error-empty-msg')\n        .remove();\n    }, 5000);\n  }\n\n  form.reset();\n}\n\nfunction waitForElement(selector, parent, callback) {\n  const observer = new MutationObserver((mutationsList, observer) => {\n    const element = parent.querySelector(selector);\n    if (element) {\n      observer.disconnect();\n      callback(element);\n    }\n  });\n\n  observer.observe(parent, { childList: true, subtree: true });\n}\n\nexport function triggerShake(el) {\n  el.classList.add('shake');\n  setTimeout(() => {\n    el.classList.remove('shake');\n  }, 350);\n}\n","import { emailCheck, msgCheck, formSubmit } from './form-check-logic';\nimport { refs } from './refs';\n\nconst STORAGE_KEY = 'feedback-form-state';\nconst form = refs.form;\nconst emailInput = refs.emailInput;\nconst textInput = refs.textInput;\n\nrefreshInputValue();\n\nemailInput.addEventListener('blur', emailCheck);\n\ntextInput.addEventListener('blur', msgCheck);\n\nform.addEventListener('submit', formSubmit);\n\nform.addEventListener('submit', handleFormSubmit);\n\nform.addEventListener('focusout', handleFormInput);\n\nfunction handleFormSubmit(event) {\n  event.preventDefault();\n  const form = event.currentTarget;\n\n  localStorage.removeItem(STORAGE_KEY);\n\n  form.reset();\n}\n\nfunction handleFormInput(event) {\n  const form = event.currentTarget;\n  const formData = new FormData(form);\n  const formDataObj = Object.fromEntries(formData.entries());\n  console.log(' handleFormInput res:', formDataObj);\n\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(formDataObj));\n}\n\nfunction refreshInputValue() {\n  const savedLSData = localStorage.getItem(STORAGE_KEY);\n\n  if (!savedLSData) return;\n\n  try {\n    const dataFromLS = JSON.parse(savedLSData);\n\n    const formEl = new FormData(form);\n    const formFields = Array.from(formEl.keys());\n    console.log(' refreshInputValue formFields:', formFields);\n\n    formFields.forEach(field => {\n      form.elements[field].value = dataFromLS[field];\n    });\n  } catch (error) {\n    alert('Ooops... something went wrong');\n  }\n}\n"],"names":["emailErrorMsg","emptyErrorMsg","refs","msgTimeoutId","emailTimeoutId","shakeId","emailCheck","correctEmailRule","existingError","emptyError","emailError","msgCheck","formSubmit","event","form","isMsgFilled","waitForElement","shakeError","triggerShake","selector","parent","callback","mutationsList","observer","element","el","STORAGE_KEY","emailInput","textInput","refreshInputValue","handleFormSubmit","handleFormInput","formData","formDataObj","savedLSData","dataFromLS","formEl","formFields","field"],"mappings":"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"}